# Test Set 4: State-Based Rule Production.
#

###############################################################################
# TC 4.1 Generate Reports based on a variable.
###############################################################################
# This test will cause an ADM report to be generated
# up to 5 times whenever Computed Data item C4 == 1.
#
###############################################################################


#------------------------------------------------------------------------------
# Step 4.1.1: Define UINT C4 = 0.
#------------------------------------------------------------------------------
# Note: C4 MID will be 0x110103030201
# NOTE: C4 EXPR TYPE is UINT (11)
# NOTE: C4 EXPR is literal uvast 4 (c70501020201100100)
# Note: C4 Type will be UINT (11)
#------------------------------------------------------------------------------
c30401010403141610061101030302010b0b01c70501020201100100010b

#------------------------------------------------------------------------------
# Step 4.1.2: Retrieve value of C4.
#------------------------------------------------------------------------------
# Generate a report that contains the value C4.
#------------------------------------------------------------------------------
c3040109030215170701110103030201020100

#------------------------------------------------------------------------------
# Step 4.1.3: Confirm value of C4 is 0.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 4.1.4: Define Macro M1 to do the following: 
#------------------------------------------------------------------------------
# - Generate an ADM Agent Report
# - Set C4 = 0 (STORE(C4, {UINT, 0})
# Note: Macro M1 will have ID: 160103060504
#------------------------------------------------------------------------------
c304010a0403121415034d3100061601030605042d02c304010903021517050182030100020100c304011603021416061101030302010b0b01c70501020201100100

#------------------------------------------------------------------------------
# Step 4.1.5: List Macros 
#------------------------------------------------------------------------------
8304010c

#------------------------------------------------------------------------------
# Step 4.1.6: Review returned report and make sure MACRO M1 is listed.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 4.1.7: Define SRL S1 to run every time C4 >= 2
#------------------------------------------------------------------------------
# Have it execute M1
# Have it run a maximum of 3 times
# SRL EXPR type is UINT (11)
# SRL EXPR is C4 2 >= 
# NOTE: C4 MID is 110103030201
# NOTE: M1 MID is 160103060504
# Note: SRL will have a MID of: 140103090807
#------------------------------------------------------------------------------
c304011206051410161015061401030908070100150b03110103030201c705010202011001028807011101030701160103060504

#------------------------------------------------------------------------------
# Step 4.1.8: List known SRLs 
#------------------------------------------------------------------------------
83040114

#------------------------------------------------------------------------------
# Step 4.1.9: Ensure that SRL1 is there.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 4.1.10: Describe SRL1
#------------------------------------------------------------------------------
c30401150201150701140103090807

#------------------------------------------------------------------------------
# Step 4.1.11: Ensure that SRL1 matches description
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 4.1.12: Set TRL rule to run every 20 seconds 6 times that will
# run the command: C4 = C4 + 1 which is: STOR(C4, {(UINT), C4 1 +})
#------------------------------------------------------------------------------
# NOTE: C4 MID is 110103030201
# NOTE: TRL ID will be 1501020101
#------------------------------------------------------------------------------
c304010e060514101010150515010201010100011401062601c30401160302141606110103030201150b03110103030201c7050102020110010188070100

#------------------------------------------------------------------------------
# Step 4.1.13: Verify SRL1 runs 3 times, approximately every 40 seconds.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 4.1.14: Inspect ADM reports for correct # TRL and SRL
# counts.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 4.1.15: List known SRLs
#------------------------------------------------------------------------------
83040114

#------------------------------------------------------------------------------
# Step 4.1.16: Verify SRL1 is there but not running (disabled)
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 4.1.17: Delete SRL 1.
#------------------------------------------------------------------------------
c30401130201150701140103090807

#------------------------------------------------------------------------------
# Step 4.1.18: List Known SRLs
#------------------------------------------------------------------------------
83040114

#------------------------------------------------------------------------------
# Step 4.1.19: Verify SRL1 no longer listed.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 4.1.20: Restart Agent and verify only 1 CD and 1 Macro restore.
# OPTIONAL
#------------------------------------------------------------------------------


